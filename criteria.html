<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>選定基準 - AI企業評価ランキング</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body>

    <header class="header">
        <div class="site-title"><a href="./index.html" data-i18n-key="siteTitle"></a></div>
        <nav class="main-nav">
            <a href="about.html" class="nav-link" data-i18n-key="navOverview"></a>
            <a href="index.html#rank-list-start" class="nav-link" data-i18n-key="navResults"></a>
            <a href="criteria.html" class="nav-link" data-i18n-key="navCriteria"></a>
            <a href="#" class="nav-link" data-i18n-key="navMenuSearch"></a>
            <div class="theme-switch-wrapper">
                <label class="theme-switch" for="theme-switch-checkbox">
                    <input type="checkbox" id="theme-switch-checkbox" />
                    <span class="slider round"></span>
                </label>
            </div>
            <div class="lang-switch">
                <span data-lang="en" class="inactive">EN</span>
                <span>/</span>
                <span data-lang="jp" class="active">JP</span>
            </div>
        </nav>
    </header>

    <main class="container" id="main-content">
        <!-- Content will be rendered by JavaScript -->
    </main>

    <script>
        const pageContent = {
            jp: {
                pageTitle: '選定基準',
                introTitle: '企業ランク研究所：私たちの選定基準について',
                introText: '当研究所の企業評価は、表面的な情報や一時的なトレンドに左右されることなく、企業の本質的な価値と将来性を多角的に分析する独自の評価モデルに基づいています。長年にわたりグローバルな信用評価、戦略コンサルティング、会計税務、人材紹介の現場で培ってきた専門的な知見を融合し、財務的健全性はもちろんのこと、従業員のエンゲージメント、企業の社会的責任（ESG）、そして将来の成長ポテンシャルまでを総合的に評価いたします。',
                modelTitle: '詳細な評価項目と数値モデル',
                modelText: '以下の4つの主要な評価領域に重み付けを行い、各領域内でさらに細分化された指標を用いて総合点を算出します。これはあくまでも当サービスの評価モデルの一例であり、市場のトレンドやデータに応じて常に最適化されます。',
                tableH1: '評価領域', tableH2: '重み', tableH3: '主な評価項目',
                cat1: '財務的健全性', cat1w: '30%', cat1i: '自己資本比率、収益性・成長性、研究開発投資',
                cat2: '社員満足度', cat2w: '30%', cat2i: '年収・待遇、働きがい・企業文化、労働環境（残業時間・有給消化率）',
                cat3: '社会的評判', cat3w: '25%', cat3i: 'ESG/CSR活動評価、法令遵守・コンプライアンス関連ニュース',
                cat4: '学生からの関心度', cat4w: '15%', cat4i: '大手就職サイト人気ランキング、採用予定人数と知名度',
                total: '総合計', totalw: '100%',
                processTitle: '評価プロセスの具体例（A社の場合）',
                processIntro: '上記のモデルに基づき、仮想の「A社」を評価した際のプロセスを以下に示します。',
                step1Title: '1. 財務的健全性（重み：30%）',
                step1Item1: '自己資本比率：同業他社と比較して安定しているため 90点',
                step1Item2: '収益性・成長性：新規事業への投資が活発で将来性が高いため 85点',
                step1Item3: '研究開発投資：業界平均を上回るため 95点',
                step1Calc: '加重点： 90点 × 0.30 = 27.0点',
                step2Title: '2. 社員満足度（重み：30%）',
                step2Item1: '年収・待遇：OpenWorkの平均年収は業界平均よりやや高いため 80点',
                step2Item2: '働きがい・企業文化：レビューで「挑戦的」「やりがいがある」との声が多いため 90点',
                step2Item3: '労働環境：残業時間が少なく、有給消化率も高いため 95点',
                step2Calc: '加重点： 88.3点 × 0.30 = 26.5点',
                step3Title: '3. 社会的評判（重み：25%）',
                step3Item1: 'ESG/CSR活動評価：社会貢献活動に積極的で、メディア露出も多いため 90点',
                step3Item2: 'コンプライアンス：過去に不祥事の報道がなく、クリーンなイメージが強いため 100点',
                step3Calc: '加重点： 95点 × 0.25 = 23.8点',
                step4Title: '4. 学生からの関心度（重み：15%）',
                step4Item1: '就職サイトランキング：人気ランキングで常に上位を維持しているため 95点',
                step4Item2: '採用予定人数と知名度：採用人数が多く、テレビCMなどで知名度が高いため 90点',
                step4Calc: '加重点： 92.5点 × 0.15 = 13.9点',
                chartTitle: 'A社 競争力分析',
                finalTitle: '最終総合点とランク付け',
                finalText: '上記の加重点を合計し、91.2点という最終総合点を算出します。この点数に基づき、A社は当研究所の<strong>「Sランク」</strong>に分類されます。このように、当研究所の評価モデルは客観的なデータに基づき、利用者様が納得のいく企業選択をできるようサポートします。'
            },
            en: {
                pageTitle: 'Selection Criteria',
                introTitle: 'Company Rank Institute: About Our Selection Criteria',
                introText: 'Our corporate evaluation is based on a unique model that analyzes the essential value and future potential of companies from multiple perspectives, without being swayed by superficial information or temporary trends. We integrate specialized knowledge cultivated over many years in global credit assessment, strategic consulting, accounting, taxation, and recruitment to comprehensively evaluate not only financial soundness but also employee engagement, corporate social responsibility (ESG), and future growth potential.',
                modelTitle: 'Detailed Evaluation Items and Numerical Model',
                modelText: 'We calculate a comprehensive score by weighting the following four main evaluation areas and using further subdivided indicators within each area. This is just one example of our service\'s evaluation model and is constantly optimized according to market trends and data.',
                tableH1: 'Evaluation Area', tableH2: 'Weight', tableH3: 'Main Evaluation Items',
                cat1: 'Financial Soundness', cat1w: '30%', cat1i: 'Equity ratio, profitability/growth, R&D investment',
                cat2: 'Employee Satisfaction', cat2w: '30%', cat2i: 'Annual income/benefits, job satisfaction/corporate culture, work environment (overtime hours/paid leave utilization)',
                cat3: 'Social Reputation', cat3w: '25%', cat3i: 'ESG/CSR activity evaluation, legal compliance/compliance-related news',
                cat4: 'Student Interest', cat4w: '15%', cat4i: 'Major job site popularity rankings, planned number of hires and name recognition',
                total: 'Total', totalw: '100%',
                processTitle: 'Example of Evaluation Process (for Company A)',
                processIntro: 'The following shows the process for evaluating a virtual \'Company A\' based on the model above.',
                step1Title: '1. Financial Soundness (Weight: 30%)',
                step1Item1: 'Equity Ratio: Stable compared to industry peers - 90 pts',
                step1Item2: 'Profitability/Growth: High potential due to active investment in new businesses - 85 pts',
                step1Item3: 'R&D Investment: Exceeds industry average - 95 pts',
                step1Calc: 'Weighted Score: 90 pts × 0.30 = 27.0 pts',
                step2Title: '2. Employee Satisfaction (Weight: 30%)',
                step2Item1: 'Annual Income/Benefits: Avg. annual income on OpenWork is slightly higher than industry avg. - 80 pts',
                step2Item2: 'Job Satisfaction/Culture: Many reviews mention "challenging" and "rewarding" - 90 pts',
                step2Item3: 'Work Environment: Low overtime hours and high paid leave utilization - 95 pts',
                step2Calc: 'Weighted Score: 88.3 pts × 0.30 = 26.5 pts',
                step3Title: '3. Social Reputation (Weight: 25%)',
                step3Item1: 'ESG/CSR Evaluation: Active in social contribution, high media exposure - 90 pts',
                step3Item2: 'Compliance: No reports of past scandals, strong clean image - 100 pts',
                step3Calc: 'Weighted Score: 95 pts × 0.25 = 23.8 pts',
                step4Title: '4. Student Interest (Weight: 15%)',
                step4Item1: 'Job Site Rankings: Consistently high in popularity rankings - 95 pts',
                step4Item2: 'Planned Hires/Name Recognition: Large number of hires, high recognition from TV commercials, etc. - 90 pts',
                step4Calc: 'Weighted Score: 92.5 pts × 0.15 = 13.9 pts',
                chartTitle: 'Company A Competitiveness Analysis',
                finalTitle: 'Final Composite Score and Ranking',
                finalText: 'By summing the weighted scores, a final composite score of 91.2 is calculated. Based on this score, Company A is classified as <strong>"S Rank"</strong> by our institute. In this way, our evaluation model, based on objective data, supports users in making corporate choices they can be satisfied with.'
            }
        };

        const navTranslations = {
            siteTitle: { jp: '企業ランク研究所', en: 'Company Rank Institute' },
            navOverview: { jp: 'サイト紹介', en: 'Overview' },
            navResults: { jp: '選定結果', en: 'Results' },
            navCriteria: { jp: '選定基準', en: 'Criteria' },
            navMenuSearch: { jp: 'メニュー検索', en: 'Menu Search' }
        };

        function renderContent(lang) {
            document.querySelectorAll('[data-i18n-key]').forEach(el => {
                const key = el.dataset.i18nKey;
                if (navTranslations[key] && navTranslations[key][lang]) {
                    el.textContent = navTranslations[key][lang];
                }
            });

            const content = pageContent[lang];
            const mainContent = document.getElementById('main-content');
            
            const radarChartSVG = createRadarChart(lang);

            mainContent.innerHTML = `
                <h1 class="page-title">${content.pageTitle}</h1>
                <section class="content-section criteria-intro">
                    <h2>${content.introTitle}</h2>
                    <p>${content.introText}</p>
                </section>

                <section class="content-section">
                    <h2>${content.modelTitle}</h2>
                    <p>${content.modelText}</p>
                    <table>
                        <thead>
                            <tr><th>${content.tableH1}</th><th>${content.tableH2}</th><th>${content.tableH3}</th></tr>
                        </thead>
                        <tbody>
                            <tr><td>${content.cat1}</td><td>${content.cat1w}</td><td>${content.cat1i}</td></tr>
                            <tr><td>${content.cat2}</td><td>${content.cat2w}</td><td>${content.cat2i}</td></tr>
                            <tr><td>${content.cat3}</td><td>${content.cat3w}</td><td>${content.cat3i}</td></tr>
                            <tr><td>${content.cat4}</td><td>${content.cat4w}</td><td>${content.cat4i}</td></tr>
                        </tbody>
                        <tfoot>
                            <tr><td><strong>${content.total}</strong></td><td><strong>${content.totalw}</strong></td><td></td></tr>
                        </tfoot>
                    </table>
                </section>

                <section class="evaluation-process-section">
                    <h3>${content.processTitle}</h3>
                    <p>${content.processIntro}</p>
                    <div class="evaluation-step">
                        <h4>${content.step1Title}</h4>
                        <ul><li>${content.step1Item1}</li><li>${content.step1Item2}</li><li>${content.step1Item3}</li></ul>
                        <p class="score-calculation">${content.step1Calc}</p>
                    </div>
                    <div class="evaluation-step">
                        <h4>${content.step2Title}</h4>
                        <ul><li>${content.step2Item1}</li><li>${content.step2Item2}</li><li>${content.step2Item3}</li></ul>
                        <p class="score-calculation">${content.step2Calc}</p>
                    </div>
                    <div class="evaluation-step">
                        <h4>${content.step3Title}</h4>
                        <ul><li>${content.step3Item1}</li><li>${content.step3Item2}</li></ul>
                        <p class="score-calculation">${content.step3Calc}</p>
                    </div>
                    <div class="evaluation-step">
                        <h4>${content.step4Title}</h4>
                        <ul><li>${content.step4Item1}</li><li>${content.step4Item2}</li></ul>
                        <p class="score-calculation">${content.step4Calc}</p>
                    </div>
                </section>
                
                <div class="chart-card">
                    <h3>${content.chartTitle}</h3>
                    <div class="radar-chart-container">
                        ${radarChartSVG}
                    </div>
                </div>

                <section class="final-score-section">
                    <h3>${content.finalTitle}</h3>
                    <p>${content.finalText}</p>
                </section>
            `;
        }

        function createRadarChart(lang) {
            const data = {
                labels: [pageContent[lang].cat1, pageContent[lang].cat2, pageContent[lang].cat3, pageContent[lang].cat4],
                datasets: [{
                    label: 'A社',
                    data: [25, 20, 22, 10],
                    max: [30, 30, 25, 15]
                }]
            };

            const size = 400;
            const center = size / 2;
            const radius = size * 0.4;
            const numLevels = 4;
            const angleSlice = Math.PI * 2 / data.labels.length;

            let svg = `<svg width="${size}" height="${size}" viewBox="0 0 ${size} ${size}" class="radar-chart">`;

            // Grid
            for (let i = 1; i <= numLevels; i++) {
                const levelRadius = radius * (i / numLevels);
                let points = '';
                for (let j = 0; j < data.labels.length; j++) {
                    const x = center + levelRadius * Math.cos(angleSlice * j - Math.PI / 2);
                    const y = center + levelRadius * Math.sin(angleSlice * j - Math.PI / 2);
                    points += `${x},${y} `;
                }
                svg += `<polygon points="${points}" class="grid"/>`;
            }

            // Axes
            for (let i = 0; i < data.labels.length; i++) {
                const x = center + radius * Math.cos(angleSlice * i - Math.PI / 2);
                const y = center + radius * Math.sin(angleSlice * i - Math.PI / 2);
                svg += `<line x1="${center}" y1="${center}" x2="${x}" y2="${y}" class="axis"/>`;
                // Labels
                const labelX = center + (radius * 1.1) * Math.cos(angleSlice * i - Math.PI / 2);
                const labelY = center + (radius * 1.1) * Math.sin(angleSlice * i - Math.PI / 2);
                const textAnchor = (i === 0 || i === data.labels.length / 2) ? 'middle' : (i > data.labels.length / 2 ? 'end' : 'start');
                svg += `<text x="${labelX}" y="${labelY}" dy=".35em" text-anchor="${textAnchor}" class="axis-label">${data.labels[i]}</text>`;
            }

            // Data Polygon
            let dataPoints = '';
            data.datasets[0].data.forEach((value, i) => {
                const dataRadius = radius * (value / data.datasets[0].max[i]);
                const x = center + dataRadius * Math.cos(angleSlice * i - Math.PI / 2);
                const y = center + dataRadius * Math.sin(angleSlice * i - Math.PI / 2);
                dataPoints += `${x},${y} `;
            });
            svg += `<polygon points="${dataPoints}" class="data-polygon"/>`;

            svg += `</svg>`;
            return svg;
        }

        function setLanguage(lang) {
            renderContent(lang);
            document.querySelectorAll('.lang-switch span[data-lang]').forEach(el => {
                el.classList.toggle('active', el.dataset.lang === lang);
                el.classList.toggle('inactive', el.dataset.lang !== lang);
            });
            localStorage.setItem('preferredLanguage', lang);
            document.documentElement.lang = lang;
            document.title = pageContent[lang].pageTitle + ' - AI企業評価ランキング';
        }

        function initializeLangSwitch() {
            document.querySelectorAll('.lang-switch span[data-lang]').forEach(el => {
                el.addEventListener('click', (e) => {
                    setLanguage(e.target.dataset.lang);
                });
            });
        }

        document.addEventListener('DOMContentLoaded', () => {
            const preferredLanguage = localStorage.getItem('preferredLanguage') || 'jp';
            initializeLangSwitch();
            setLanguage(preferredLanguage);
        });
    </script>

    <script src="theme.js"></script>
</body>
</html>
